"""Tests for {{ spec.name }}.

Generated by Forge â€” Self-Evolving Tool Agent.
"""

import pytest

{% if output_type == "cli" %}
from click.testing import CliRunner
from {{ module_name }} import main, _run
{% elif output_type == "mcp" %}
from {{ module_name }} import {{ spec.name }}
{% else %}
from {{ module_name }} import {{ spec.name }}
{% endif %}


class Test{{ spec.name | title | replace('_', '') }}:
    """Test suite for {{ spec.name }}."""

{% for example in spec.examples %}
    def test_example_{{ loop.index0 }}(self):
        """Test with example: {{ example.get('description', 'example ' ~ loop.index) }}."""
{% if output_type == "cli" %}
        result = _run({{ example.get('args', '') }})
{% else %}
        result = {{ spec.name }}({{ example.get('args', '') }})
{% endif %}
        assert result is not None
{% if example.get('expected') %}
        assert result == {{ example['expected'] | tojson }}
{% endif %}

{% endfor %}
{% if not spec.examples %}
    def test_basic(self):
        """Basic invocation test."""
{% if output_type == "cli" %}
        # Ensure the function is callable
        assert callable(_run)
{% else %}
        # Ensure the function is callable
        assert callable({{ spec.name }})
{% endif %}

{% endif %}
{% if output_type == "cli" %}
    def test_cli_help(self):
        """Test that CLI --help works."""
        runner = CliRunner()
        result = runner.invoke(main, ["--help"])
        assert result.exit_code == 0
        assert "{{ spec.name | replace('_', '-') }}" in result.output.lower() or "usage" in result.output.lower()

{% endif %}
