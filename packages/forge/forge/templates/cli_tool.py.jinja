#!/usr/bin/env python3
"""CLI tool: {{ spec.display_name or spec.name }}

{{ spec.description }}

Generated by Forge â€” Self-Evolving Tool Agent.
"""

import sys

import click
{% if spec.dependencies %}
{% for dep in spec.dependencies %}
import {{ dep }}
{% endfor %}
{% endif %}


@click.command()
{%- for param in spec.params %}
{% if param.required %}
@click.argument("{{ param.name }}")
{%- else %}
@click.option("--{{ param.name | replace('_', '-') }}", default={{ param.default | default("None", true) | tojson }}, help="{{ param.description }}")
{%- endif %}
{%- endfor %}
def main(
{%- for param in spec.params %}
    {{ param.name }}: {{ param.type_hint }}{% if not param.required %} = {{ param.default | default("None", true) }}{% endif %},
{%- endfor %}
) -> None:
    """{{ spec.description }}"""
    try:
        result = _run({% for param in spec.params %}{{ param.name }}{% if not loop.last %}, {% endif %}{% endfor %})
        click.echo(result)
    except Exception as e:
        click.echo(f"Error: {e}", err=True)
        sys.exit(1)


def _run(
{%- for param in spec.params %}
    {{ param.name }}: {{ param.type_hint }}{% if not param.required %} = {{ param.default | default("None", true) }}{% endif %},
{%- endfor %}
) -> {{ spec.return_type }}:
    """Core logic for {{ spec.name }}.

    Args:
{%- for param in spec.params %}
        {{ param.name }}: {{ param.description }}
{%- endfor %}

    Returns:
        {{ spec.return_description or spec.return_type }}
    """
    {{ spec.core_logic | indent(4) }}


if __name__ == "__main__":
    main()
